# প্রোডাক্টস স্কিমা ক্যাশ সমস্যা সমাধান

## সমস্যা

প্রোডাক্ট অ্যাড করার সময় নিম্নলিখিত এরর দেখা যাচ্ছে:

**"Could not find the 'image_url' column of 'products' in the schema cache"**

এই এরর হচ্ছে কারণ Supabase এর ইন্টারনাল স্কিমা ক্যাশ আসল ডাটাবেস স্কিমার সাথে সিঙ্ক্রোনাইজড নয়। যদিও `image_url` কলাম ডাটাবেস টেবিলে আছে, Supabase ক্লায়েন্ট এটি চিনতে পারছে না।

## সমাধান

আমরা স্কিমা ক্যাশ রিফ্রেশ করার জন্য স্ক্রিপ্ট তৈরি করেছি যা Supabase কে তার ইন্টারনাল স্কিমা আপডেট করতে বাধ্য করে।

### অপশন ১: স্ক্রিপ্ট রান করুন

সবচেয়ে সহজ উপায় হল প্রদত্ত স্ক্রিপ্ট রান করা:

```bash
npm run fix-products-schema
```

এই স্ক্রিপ্ট:
1. Supabase এ সার্ভিস রোল কী ব্যবহার করে কানেক্ট করে
2. SQL কমান্ড এক্সিকিউট করে যা স্কিমা ক্যাশ রিফ্রেশ করতে বাধ্য করে
3. অপারেশন সম্পন্ন হলে নিশ্চিত করে

### অপশন ২: ম্যানুয়াল SQL এক্সিকিউশন

যদি স্ক্রিপ্ট কাজ না করে, আপনি ম্যানুয়ালি SQL কমান্ড এক্সিকিউট করতে পারেন:

1. Supabase ড্যাশবোর্ডে যান
2. SQL এডিটর খুলুন
3. `scripts/complete_products_fix.sql` এর কন্টেন্ট কপি করে পেস্ট করুন
4. SQL এক্সিকিউট করুন

## যাচাই

ফিক্স রান করার পরে:

1. আপনার Next.js ডেভেলপমেন্ট সার্ভার রিস্টার্ট করুন (`npm run dev`)
2. অ্যাডমিন প্রোডাক্টস পেজে যান
3. এরর সমাধান হওয়া উচিত, এবং আপনি প্রোডাক্ট যোগ করতে ও ম্যানেজ করতে সক্ষম হবেন

## টেকনিক্যাল বিবরণ

ফিক্স কাজ করে এভাবে:

1. সঠিক স্ট্রাকচার সহ টেবিল আছে কিনা নিশ্চিত করে
2. `image_url` কলামে একটি কমেন্ট যোগ করে
3. কলামের ডাটা টাইপ পরিবর্তন করে (একই টাইপে) স্কিমা রিফ্রেশ করতে বাধ্য করে
4. একটি অস্থায়ী ভিউ তৈরি করে এবং ড্রপ করে যা সব কলাম রেফারেন্স করে

এই অপারেশনগুলি Supabase কে তার ইন্টারনাল স্কিমা ক্যাশ আপডেট করতে বাধ্য করে আসল ডাটাবেস স্ট্রাকচার পরিবর্তন না করে।

## প্রতিরোধ

এই সমস্যা সাধারণত হয় যখন:

1. ডাটাবেস স্কিমা Supabase এর ইন্টারফেস বাইরে থেকে পরিবর্তন করা হয়
2. Supabase এর ক্যাশ এবং আসল ডাটাবেসের মধ্যে সিঙ্ক্রোনাইজেশন সমস্যা থাকে

ভবিষ্যতে এটি প্রতিরোধ করতে, বিবেচনা করুন:

- স্কিমা পরিবর্তনের জন্য Supabase মাইগ্রেশন ব্যবহার করা
- বড় স্কিমা পরিবর্তনের পরে রিফ্রেশ স্ক্রিপ্ট রান করা
- স্কিমা পরিবর্তনের পরে Supabase ক্লায়েন্ট রিস্টার্ট করা