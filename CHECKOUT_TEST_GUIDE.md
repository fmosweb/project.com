# ЁЯзк ржЕрж░рзНржбрж╛рж░/ржЪрзЗржХржЖржЙржЯ ржЯрзЗрж╕рзНржЯ ржЧрж╛ржЗржб

## тЬЕ ржкрзНрж░рж┐-рж░рзЗржХрзБржЗржЬрж┐ржЯ
- .env.local рж╕ржарж┐ржХржнрж╛ржмрзЗ рж╕рзЗржЯ ржЖржЫрзЗ ржХрж┐ржирж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржи
  - `NEXT_PUBLIC_SUPABASE_URL`
  - `NEXT_PUBLIC_SUPABASE_ANON_KEY`
  - `SUPABASE_SERVICE_ROLE_KEY`
  - рж░рзЗржлрж╛рж░рзЗржирзНрж╕: `env-example.txt`
- ржбрж╛ржЯрж╛ржмрзЗрж╕ рж╕рзНржХрж┐ржорж╛ рж░рж╛ржи рж╣ржпрж╝рзЗржЫрзЗ ржХрж┐ржирж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржи
  - рж╕рзБржкрж╛рж░рж┐рж╢: `scripts/clean_database_setup.sql`
  - рж╕рзНржпрж╛ржорзНржкрж▓ ржбрж╛ржЯрж╛ ржжрж┐рждрзЗ ржЪрж╛ржЗрж▓рзЗ: `scripts/insert_sample_data.sql`

## ЁЯзн ржЯрзЗрж╕рзНржЯ рж░рзБржЯрж╕
- Checkout: `http://localhost:3000/checkout`
- Order Creation Test: `http://localhost:3000/test-order-creation`

## ЁЯЪА ржЯрзЗрж╕рзНржЯ ржХрж░рж╛рж░ ржзрж╛ржк
1) ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗ `http://localhost:3000/test-order-creation` ржЦрзБрж▓рзБржи
   - тАЬTest Order CreationтАЭ ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзБржи
   - рж╕ржлрж▓ рж╣рж▓рзЗ JSON-ржП `success: true` ржПржмржВ `id: <uuid>` ржжрзЗржЦрждрзЗ ржкрж╛ржмрзЗржи
2) `http://localhost:3000/checkout` ржкрзЗржЬрзЗ ржпрж╛ржи
   - ржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржлрж┐рж▓рзНржбржЧрзБрж▓рзЛ ржкрзВрж░ржг ржХрж░рзБржи
   - ржкрзЗржорзЗржирзНржЯ ржорзЗржержб рж╣рж┐рж╕рзЗржмрзЗ Cash on Delivery рж╕рж┐рж▓рзЗржХрзНржЯ ржХрж░рзБржи
   - тАЬPlace OrderтАЭ ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзБржи
   - рж╕ржлрж▓ рж╣рж▓рзЗ `/checkout/success?orderId=<uuid>&method=cod` ржП рж░рж┐ржбрж╛ржЗрж░рзЗржХрзНржЯ рж╣ржмрзЗ

## ЁЯФз ржЯрзЗржХржирж┐ржХрзНржпрж╛рж▓ ржирзЛржЯрж╕ (ржХрзЛржб рж░рзЗржлрж╛рж░рзЗржирзНрж╕)
- ржЕрж░рзНржбрж╛рж░ API: `app/api/orders/create/route.ts`
  - DB-ржХрзЗ ржирж┐ржЬрзЗ ржерзЗржХрзЗ UUID ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рждрзЗ ржжрзЗржпрж╝ (ржорзНржпрж╛ржирзБржпрж╝рж╛рж▓ рж╕рзНржЯрзНрж░рж┐ржВ ржЖржЗржбрж┐ ржиржпрж╝)
  - `payment_method` normalize ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ: `cash-on-delivery` тЖТ `cash_on_delivery`
  - ржоржХ ржХрж╛рж░рзНржЯ ржЖржЗржЯрзЗржорзЗ `id` рж╕ржВржЦрзНржпрж╛ рж╣рждрзЗ ржкрж╛рж░рзЗ; valid UUID ржирж╛ рж╣рж▓рзЗ `order_items` ржЗржирж╕рж╛рж░рзНржЯ рж╕рзНржХрж┐ржк рж╣ржпрж╝ (ржЕрж░рзНржбрж╛рж░ рждрзИрж░рж┐ рждржмрзБржУ рж╣ржмрзЗ)
- Supabase Admin Client: `lib/supabase/admin.ts`
  - `.env.local` ржирж╛ ржерж╛ржХрж▓рзЗ mock client ржмрзНржпржмрж╣рзГржд рж╣ржпрж╝ ржПржмржВ insert ржмрзНржпрж░рзНрже рж╣ржпрж╝

## тЬЕ ржПржХрзНрж╕ржкрзЗржХрзНржЯрзЗржб рж░рзЗржЬрж╛рж▓рзНржЯ
- `/api/orders/create` рж░рзЗрж╕ржкржирзНрж╕: `{ success: true, id: <uuid>, order: {...} }`
- COD рж╣рж▓рзЗ рж╕рж░рж╛рж╕рж░рж┐ Success ржкрзЗржЬрзЗ рж░рж┐ржбрж╛ржЗрж░рзЗржХрзНржЯ
- Admin panel (Orders) ржП ржирждрзБржи ржЕрж░рзНржбрж╛рж░ ржжрзЗржЦрж╛ ржпрж╛ржмрзЗ

## ЁЯРЫ ржЯрзНрж░рж╛ржмрж▓рж╢рзБржЯрж┐ржВ
- 500: тАЬржЕрж░рзНржбрж╛рж░ рждрзИрж░рж┐рждрзЗ рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝рзЗржЫрзЗтАЭ
  - `.env.local` ржПрж░ ржХрзА-ржЧрзБрж▓рзЛ рж╕ржарж┐ржХ ржХрж┐ржирж╛ ржЪрзЗржХ ржХрж░рзБржи
  - Supabase рж╕рзНржХрж┐ржорж╛ рж╕ржарж┐ржХ ржХрж┐ржирж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржи (`scripts/clean_database_setup.sql`)
  - API рж░рзЗрж╕ржкржирзНрж╕рзЗ `details`/`code` ржерж╛ржХрж▓рзЗ рж╕рзЗржЯрж┐ ржжрзЗржЦрзЗ ржмрзНржпржмрж╕рзНржерж╛ ржирж┐ржи
- 404 ржЗржорзЗржЬ тЖТ UI ржЕрзНржпрж╛рж╕рзЗржЯ ржорж┐рж╕рж┐ржВ, ржЕрж░рзНржбрж╛рж░ рждрзИрж░рж┐рждрзЗ ржмрж╛ржзрж╛ ржиржпрж╝
- bKash/Nagad/Rocket тЖТ ржмрж░рзНрждржорж╛ржирзЗ placeholder redirect; ржЯрзЗрж╕рзНржЯрзЗ COD ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи

## ЁЯзк Supabase ржХрж╛ржирзЗржХрж╢ржи ржЯрзЗрж╕рзНржЯ (ржРржЪрзНржЫрж┐ржХ)
- рж╕рзНржХрзНрж░рж┐ржкрзНржЯ: `test-supabase.js`
- рж░рж╛ржи ржХрж░рзБржи:
  - `node test-supabase.js`
  - ржЖржЙржЯржкрзБржЯрзЗ URL/Key рж╕рзЗржЯ ржЖржЫрзЗ ржХрж┐ржирж╛ ржПржмржВ `products` select рж░рзЗрж╕ржкржирзНрж╕ ржжрзЗржЦрзБржи

## тД╣я╕П ржирзЛржЯ
- ржоржХ ржХрж╛рж░рзНржЯ (`/checkout`) ржЖржЗржЯрзЗржоржЧрзБрж▓рзЛрж░ `id` рж╕ржВржЦрзНржпрж╛ рж╣ржУржпрж╝рж╛ржпрж╝ `order_items` ржЗржирж╕рж╛рж░рзНржЯ рж╕рзНржХрж┐ржк рж╣рждрзЗ ржкрж╛рж░рзЗред ржкрзНрж░рзЛржбрж╛ржХрж╢ржирзЗ ржЖрж╕рж▓ ржкрзНрж░рзЛржбрж╛ржХрзНржЯ UUID ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржЖржЗржЯрзЗржоржЧрзБрж▓рзЛржУ ржЗржирж╕рж╛рж░рзНржЯ рж╣ржмрзЗред
